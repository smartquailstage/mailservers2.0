  # Configuración para los servicios IMAP, POP3, Submission, LMTP, y autenticación

  ############################################
  # IMAP (puertos estándar)
  ############################################
service imap-login {
  inet_listener imap {
    port = 143
    ssl = no
    bind = 0.0.0.0
  }
  inet_listener imaps {
    port = 993
    ssl = yes
    bind = 0.0.0.0
  }
}

  ############################################
  # POP3 (puertos estándar)
  ############################################
service pop3-login {
  inet_listener pop3 {
    port = 110
    ssl = no
    bind = 0.0.0.0
  }
  inet_listener pop3s {
    port = 995
    ssl = yes
    bind = 0.0.0.0
  }
}

  ############################################
  # Submission (STARTTLS - para envío de correos desde clientes)
  ############################################
  service submission-login {
    inet_listener submission {
      port = 587
      ssl = yes
    }
  }

  ############################################
  # LMTP para entrega local desde Postfix (mantener)
  ############################################
  service lmtp {
    # Eliminamos el listener por socket Unix
    # unix_listener /var/spool/postfix/private/dovecot-lmtp {
    #   user = postfix
    #   group = postfix
    #   mode = 0660
    # }

    # Listener TCP para Postfix → Dovecot LMTP
    inet_listener lmtp {
      port = 24  # ⚠️ Este puerto está bien definido así. No tocar.
      # bind = 0.0.0.0  # Puedes habilitar esto si quieres escuchar en todas las interfaces
    }
  }

  ############################################
  # Autenticación (Auth y Auth-Worker)
  ############################################
  service auth {
    # Listener TCP interno para SASL (Postfix usa esto)
    inet_listener auth {
      port = 12345
    }

    # Listeners Unix internos para Dovecot
    unix_listener auth-userdb {
      mode = 0660
      user = dovecot
      group = dovecot
    }

    unix_listener auth-client {
      mode = 0660
      user = dovecot
      group = dovecot
    }
  }

  service auth-worker {
    user = dovecot
  }

  ############################################
  # Configuración general
  ############################################
  mail_privileged_group = mail
  protocols = imap pop3 lmtp
